<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE>Untitled Page</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<STYLE type=text/css>
{
FONT-SIZE


:

 

12
px




}
.gridView {
	BORDER-RIGHT: #bad6ec 1px;
	BORDER-TOP: #bad6ec 1px;
	BORDER-LEFT: #bad6ec 1px;
	COLOR: #566984;
	BORDER-BOTTOM: #bad6ec 1px;
	FONT-FAMILY: Courier New
}

.gridViewHeader {
	BORDER-RIGHT: #bad6ec 1px solid;
	BORDER-TOP: #bad6ec 1px solid;
	BACKGROUND-IMAGE: url(../images/bg_th.gif);
	BORDER-LEFT: #bad6ec 1px solid;
	LINE-HEIGHT: 27px;
	BORDER-BOTTOM: #bad6ec 1px solid
}

.gridViewItem {
	BORDER-RIGHT: #bad6ec 1px solid;
	BORDER-TOP: #bad6ec 1px solid;
	BORDER-LEFT: #bad6ec 1px solid;
	LINE-HEIGHT: 32px;
	BORDER-BOTTOM: #bad6ec 1px solid;
	TEXT-ALIGN: left;
}

.cmdField {
	BORDER-RIGHT: 0px;
	BORDER-TOP: 0px;
	BACKGROUND-IMAGE: url(../images/bg_rectbtn.png);
	OVERFLOW: hidden;
	BORDER-LEFT: 0px;
	WIDTH: 67px;
	COLOR: #364c6d;
	LINE-HEIGHT: 27px;
	BORDER-BOTTOM: 0px;
	BACKGROUND-REPEAT: repeat-x;
	HEIGHT: 27px;
	BACKGROUND-COLOR: transparent;
	TEXT-DECORATION: none
}

.buttonBlue {
	BORDER-RIGHT: 0px;
	BORDER-TOP: 0px;
	BACKGROUND-IMAGE: url(../images/bg_button_blue.gif);
	BORDER-LEFT: 0px;
	WIDTH: 78px;
	COLOR: white;
	BORDER-BOTTOM: 0px;
	BACKGROUND-REPEAT: no-repeat;
	HEIGHT: 21px
}

#showDetail {
	width: 100%;
	height: 100%;
	position: absolute;
	left: 0;
	top: 0;
	background: rgba(0, 0, 0, 0.3);
}

#showDetail div {
	width: 650px;
	height: 300px;
	background: #ffffff;
	border: 1px solid #c5c0c0;
	border-radius: 10px;
	margin-top: 30px;
	position: relative;
}

#showDetail div img {
	width: 36px;
	height: 36px;
	position: absolute;
	right: -20px;
	top: -17px;
}
</STYLE>
<META content="MSHTML 6.00.2900.5848" name=GENERATOR>
</HEAD>
<BODY
	style="BACKGROUND-POSITION-Y: -120px; BACKGROUND-IMAGE: url(../images/bg.gif); BACKGROUND-REPEAT: repeat-x">

	<SCRIPT type=text/javascript>
		//<![CDATA[
		var theForm = document.forms['aspnetForm'];
		if (!theForm) {
			theForm = document.aspnetForm;
		}
		function __doPostBack(eventTarget, eventArgument) {
			if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
				theForm.__EVENTTARGET.value = eventTarget;
				theForm.__EVENTARGUMENT.value = eventArgument;
				theForm.submit();
			}
		}
		//]]>
	</SCRIPT>
	<DIV>
		<TABLE height="100%" cellSpacing=0 cellPadding=0 width="100%" border=0>
			<TBODY>
				<TR
					style="BACKGROUND-IMAGE: url(../images/bg_header.gif); BACKGROUND-REPEAT: repeat-x"
					height=47>
					<TD width=10><SPAN
						style="FLOAT: left; BACKGROUND-IMAGE: url(../images/main_hl.gif); WIDTH: 15px; BACKGROUND-REPEAT: no-repeat; HEIGHT: 47px"></SPAN></TD>
					<TD><SPAN
						style="FLOAT: left; BACKGROUND-IMAGE: url(../images/main_hl2.gif); WIDTH: 15px; BACKGROUND-REPEAT: no-repeat; HEIGHT: 47px"></SPAN><SPAN
						style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; FLOAT: left; BACKGROUND-IMAGE: url(../images/main_hb.gif); PADDING-BOTTOM: 10px; COLOR: white; PADDING-TOP: 10px; BACKGROUND-REPEAT: repeat-x; HEIGHT: 47px; TEXT-ALIGN: center; 0 px:">百汇金服H5列表
					</SPAN><SPAN
						style="FLOAT: left; BACKGROUND-IMAGE: url(../images/main_hr.gif); WIDTH: 60px; BACKGROUND-REPEAT: no-repeat; HEIGHT: 47px"></SPAN></TD>
					<TD
						style="BACKGROUND-POSITION: 50% bottom; BACKGROUND-IMAGE: url(../images/main_rc.gif)"
						width=10></TD>
				</TR>
				<TR>
					<TD style="BACKGROUND-IMAGE: url(../images/main_ls.gif)">&nbsp;</TD>
					<TD
						style="position: relative; PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; COLOR: #566984; PADDING-TOP: 10px; BACKGROUND-COLOR: white"
						vAlign=top align=middle>

						<DIV align=left>
							<button onclick="add();">添加</button>
							&nbsp;&nbsp;&nbsp;&nbsp;
							<button onclick="clears();">清空</button>
						</DIV> <br>
						
						
						<DIV id='show'></DIV>

						<DIV id='showDetail' style="display: none"></DIV>


					</TD>
					<TD style="BACKGROUND-IMAGE: url(../images/main_rs.gif)"></TD>
				</TR>
				<TR
					style="BACKGROUND-IMAGE: url(../images/main_fs.gif); BACKGROUND-REPEAT: repeat-x"
					height=10>
					<TD style="BACKGROUND-IMAGE: url(../images/main_lf.gif)"></TD>
					<TD style="BACKGROUND-IMAGE: url(../images/main_fs.gif)"></TD>
					<TD style="BACKGROUND-IMAGE: url(../images/main_rf.gif)"></TD>
				</TR>
			</TBODY>
		</TABLE>
	</DIV>
	<script type="text/javascript" src="../js/jquery-1.10.2.min.js"></script>
	<SCRIPT type=text/javascript>
		$(function() {
			var detail_html = '';
			var html = '<TABLE class=gridView id=ctl00_ContentPlaceHolder2_GridView1 style="WIDTH: 100%; BORDER-COLLAPSE: collapse" cellSpacing=0 rules=all  border=1><tbody>';
			html += '<TR>'
					+ '<TH class=gridViewHeader style="WIDTH: 50px" scope=col>序号</TH>'
					+ '<TH class=gridViewHeader scope=col>用例编号</TH>'
					+ '<TH class=gridViewHeader scope=col>用例简称</TH>'
					+ '<TH class=gridViewHeader scope=col>用例描述</TH>'
					+ '<TH class=gridViewHeader scope=col>创建时间</TH>'
					+ '<TH class=gridviewHeader scope=col>操作</TH>'
					+ '<TH class=gridviewHeader scope=col>执行开始时间</TH>'
					+ '<TH class=gridviewHeader scope=col>执行结束时间</TH>'
					+ '<TH class=gridviewHeader scope=col>执行结果</TH>' + '</TR>';

			$
					.ajax({
						url : 'case/op/show',
						type : "get",
						dataType : "json",
						success : function(result) {
							$
									.each(
											result,
											function(i) {
												html += ' <TR> '
														+ '<TD class=gridViewItem style="WIDTH: 50px">'
														+ (i + 1)
														+ ' </TD>'
														+ '<TD class=gridViewItem><A href="h5_add.htm?id='
														+ result[i].id
														+ '">'
														+ result[i].caseNum
														+ '</A></TD>'
														+ '<TD class=gridViewItem>'
														+ result[i].caseName
														+ '</TD>'
														+ '<TD class=gridViewItem><a href="javascript:showDetail(\'detail_'
														+ result[i].id
														+ '\')" >点击查看</a></TD>'
														+ '<TD class=gridViewItem>'
														+ result[i].createTime
														+ '</TD>'
														+ '<TD class=gridViewItem><A href="javascript:run('
														+ result[i].id + ',\''
														+ result[i].caseNum
														+ '\');">启动</A></TD>';
												if (result[i].startTime == ''
														|| result[i].startTime == null) {
													html += '<TD class=gridViewItem><span id="start_'+result[i].id+'"></span></TD>';
												} else {
													html += '<TD class=gridViewItem><span id="start_'+result[i].id+'">'
															+ result[i].startTime
															+ '</span></TD>';

												}
												if (result[i].endTime == ''
														|| result[i].endTime == null) {
													html += '<TD class=gridViewItem><span id="end_'+result[i].id+'"></span> </TD>';
												} else {
													html += '<TD class=gridViewItem><span id="end_'+result[i].id+'">'
															+ result[i].endTime
															+ '</span> </TD>';

												}
												if (result[i].results == 'false') {
													html += '<TD class=gridViewItem><span id="span_'+result[i].id+'"><font color="#FF0000">失败</font></span> </TD>'
												} else {
													if (result[i].results == ''
															|| result[i].results == null) {
														html += '<TD class=gridViewItem><span id="span_'+result[i].id+'"></span> </TD>'
													} else {
														html += '<TD class=gridViewItem><span id="span_'+result[i].id+'">成功</span> </TD>'
													}
												}
												html += '</TR>';
											});
							html += ' </TBODY> </TABLE>';
							$('#show').html(html);

							$
									.each(
											result,
											function(i) {
												detail_html += '<DIV align=left id = detail_'+result[i].id+' style="display: none">'
														+ result[i].caseDetail
														+ '<a href="javascript:closed(\'detail_'
														+ result[i].id
														+ '\')"><img src="../images/close.png" /></a></DIV>'
											});
							$('#showDetail').html(detail_html);
						}

					});
		});

		function p(s) {
			return s < 10 ? '0' + s : s;
		}
		/**
		 * 
		 * 获取当前时间
		 */
		function getCurrentTiem() {
			var myDate = new Date();
			//获取当前年
			// 		var year=myDate.getFullYear();
			//获取当前月
			// 		var month=myDate.getMonth()+1;
			//获取当前日
			// 		var date=myDate.getDate(); 
			var h = myDate.getHours(); //获取当前小时数(0-23)
			var m = myDate.getMinutes(); //获取当前分钟数(0-59)
			var s = myDate.getSeconds();

			// 		var now=year+'-'+p(month)+"-"+p(date)+" "+p(h)+':'+p(m)+":"+p(s);
			var now = p(h) + ':' + p(m) + ":" + p(s);
			return now;
		}

		function run(id, caseNum) {
			$('#start_' + id).text(getCurrentTiem());
			$.ajax({
				url : 'case/op/run/' + id + "?caseNum=" + caseNum,
				type : "get",
				dataType : "json",
				success : function(result) {
					if (result == false) {
						var rt = '<font color="#FF0000">失败</font>';
						$('#span_' + id).html(rt);
					} else {
						$('#span_' + id).text('成功');
					}
					$('#end_' + id).text(getCurrentTiem());
				}
			});
		};
		// 用例描述
		function showDetail(id) {
			$('#showDetail').show();
			$('#' + id).show();
		}
		function closed(id) {
			$('#showDetail').hide();
			$('#' + id).hide();
		}
		function add() {
			window.location.href = 'h5_add.htm';
		}
		function clears() {
			$.ajax({
				url : 'case/op/clear',
				type : "get",
				dataType : "json",
				success : function(result) {
					location.reload();
				}
			});
		}
		//<![CDATA[
		// 	Sys.Application.initialize();
		//]]>
	</SCRIPT>
</BODY>
</HTML>
